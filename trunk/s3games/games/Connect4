[BOARD]    
image=connect4board.png

[REALBOARD ELEMENT TYPES]
name=white
state=1
hueMin=71
hueMax=192
saturationMin=0.27
saturationMax=1.0
valueMin=0.09
valueMax=0.9
sizeMin=200
sizeMax=5000

name=red
hueMin=337
hueMax=19
saturationMin=0.44
saturationMax=1.0
valueMin=0.28
valueMax=1.0
sizeMin=200
sizeMax=5000

[ELEMENT TYPES]
name=white
states=1
image=connect4white.png
point=1,1

name=red
states=1
image=connect4red.png
point=1,1


[LOCATION TYPES]

name=grid
image=emptyplace.png
shape=circle(22)
point=1,1

name=stackr
image=connect4grey.png
shape=circle(25)
point=1,1
relevant=no

name=stackw
image=connect4grey.png
shape=circle(25)
point=1,1
relevant=no

[LOCATIONS]

name=sw(1)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(2)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(3)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(4)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(5)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(6)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(7)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(8)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(9)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(10)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(11)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(12)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(13)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(14)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(15)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(16)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(17)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sw(18)
type=stackw
point=129,293
robot=-50,30,-36,-60,-29,-50,3,-36,-60,-29

name=sr(1)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(2)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(3)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(4)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(5)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(6)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(7)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(8)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(9)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(10)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(11)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(12)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(13)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(14)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(15)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(16)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=sr(17)
type=stackr
point=272,293
robot=48,20,-32,-60,32,48,-1,-32,-60,32

name=b(1,1)
type=grid
point=50,36
camera=85,44
robot=-22,-35,23,-64,50,-21,-41,23,-64,50

name=b(2,1)
type=grid
point=100,36
camera=165,44
robot=-13,-35,33,-76,86,-13,-47,32,-76,86

name=b(3,1)
type=grid
point=150,36
camera=245,44
robot=-6,-35,30,-80,47,-6,-38,18,-66,47

name=b(4,1)
type=grid
point=200,36
camera=325,44
robot=2,-35,30,-76,86,0,-46,30,-76,86

name=b(5,1)
type=grid
point=250,36
camera=405,44
robot=8,-29,17,-61,64,8,-37,17,-61,64

name=b(6,1)
type=grid
point=300,36
camera=485,44
robot=17,-35,30,-70,86,17,-44,30,-70,86

name=b(7,1)
type=grid
point=350,36
camera=565,44
robot=23,-30,33,-65,86,23,-47,33,-67,86

name=b(1,2)
type=grid
point=50,86
camera=85,123
robot=-25,-2,-8,-61,12,-25,-32,7,-61,12

name=b(2,2)
type=grid
point=100,86
camera=166,123
robot=-19,2,-14,-33,-53,-17,-29,3,-60,-53

name=b(3,2)
type=grid
point=150,86
camera=246,123
robot=-8,14,-14,-57,54,-8,-27,-1,-57,54

name=b(4,2)
type=grid
point=200,86
camera=326,123
robot=1,0,-2,-55,73,0,-31,5,-63,73

name=b(5,2)
type=grid
point=250,86
camera=406,123
robot=11,0,2,-59,63,11,-28,2,-59,63

name=b(6,2)
type=grid
point=300,86
camera=486,123
robot=18,0,7,-63,95,18,-31,7,-63,95

name=b(7,2)
type=grid
point=350,86
camera=566,123
robot=26,-10,10,-56,90,26,-33,10,-56,90

name=b(1,3)
type=grid
point=50,136
camera=86,202
robot=-30,0,-4,-61,29,-27,-24,-4,-61,29

name=b(2,3)
type=grid
point=100,136
camera=166,202
robot=-16,-5,5,-62,44,-19,-21,-8,-62,44

name=b(3,3)
type=grid
point=150,136
camera=246,202
robot=-7,10,3,-65,44,-9,-22,-9,-65,44

name=b(4,3)
type=grid
point=200,136
camera=326,202
robot=-1,0,-5,-31,62,1,-18,-14,-59,-31

name=b(5,3)
type=grid
point=250,136
camera=406,202
robot=13,2,-6,-67,75,10,-18,-12,-59,75

name=b(6,3)
type=grid
point=300,136
camera=486,202
robot=24,0,-11,-53,70,20,-25,-4,-61,70

name=b(7,3)
type=grid
point=350,136
camera=566,202
robot=28,-12,1,-64,-93,30,-31,7,-67,-93

name=b(1,4)
type=grid
point=50,186
camera=86,282
robot=-30,6,-17,-60,-69,-33,-13,-17,-60,-69

name=b(2,4)
type=grid
point=100,186
camera=166,282
robot=-24,12,-20,-60,-61,-22,-10,-24,-60,-61

name=b(3,4)
type=grid
point=150,186
camera=246,282
robot=-9,30,-28,-57,-44,-11,-6,-28,-57,-51

name=b(4,4)
type=grid
point=200,186
camera=326,282
robot=1,20,-28,-57,-26,1,-6,-28,-57,-26

name=b(5,4)
type=grid
point=250,186
camera=406,282
robot=13,20,-28,-57,59,15,-6,-27,-54,59

name=b(6,4)
type=grid
point=300,186
camera=486,282
robot=25,20,-29,-57,-26,25,-12,-21,-57,-26

name=b(7,4)
type=grid
point=350,186
camera=566,282
robot=36,2,-13,-59,-2,36,-17,-13,-59,-2

name=b(1,5)
type=grid
point=50,236
camera=86,362
robot=-39,20,-30,-56,-2,-39,-3,-30,-56,-2

name=b(2,5)
type=grid
point=100,236
camera=166,362
robot=-28,30,-36,-56,-2,-28,3,-36,-56,-2

name=b(3,5)
type=grid
point=150,236
camera=246,362
robot=-14,22,-35,-64,-7,-14,1,-35,-64,-7

name=b(4,5)
type=grid
point=200,236
camera=326,361
robot=5,25,-36,-63,-50,5,2,-36,-63,-50

name=b(5,5)
type=grid
point=250,236
camera=406,360
robot=22,30,-36,-69,-53,16,3,-36,-60,-69

name=b(6,5)
type=grid
point=300,236
camera=486,359
robot=31,25,-29,-60,89,29,-5,-29,-59,89

name=b(7,5)
type=grid
point=350,236
camera=566, 358
robot=42,20,-19,-60,71,42,-13,-19,-60,71

[PLAYER NAMES]
1=white
2=red

[MOVABLE ELEMENTS]
            
name=w(1)
type=white
location=sw(1)

name=w(2)
type=white
location=sw(2)

name=w(3)
type=white
location=sw(3)

name=w(4)
type=white
location=sw(4)

name=w(5)
type=white
location=sw(5)

name=w(6)
type=white
location=sw(6)

name=w(7)
type=white
location=sw(7)

name=w(8)
type=white
location=sw(8)

name=w(9)
type=white
location=sw(9)

name=w(10)
type=white
location=sw(10)

name=w(11)
type=white
location=sw(11)

name=w(12)
type=white
location=sw(12)

name=w(13)
type=white
location=sw(13)

name=w(14)
type=white
location=sw(14)

name=w(15)
type=white
location=sw(15)

name=w(16)
type=white
location=sw(16)

name=w(17)
type=white
location=sw(17)

name=w(18)
type=white
location=sw(18)

name=r(1)
type=red
location=sr(1)

name=r(2)
type=red
location=sr(2)

name=r(3)
type=red
location=sr(3)

name=r(4)
type=red
location=sr(4)

name=r(5)
type=red
location=sr(5)

name=r(6)
type=red
location=sr(6)

name=r(7)
type=red
location=sr(7)

name=r(8)
type=red
location=sr(8)

name=r(9)
type=red
location=sr(9)

name=r(10)
type=red
location=sr(10)

name=r(11)
type=red
location=sr(11)

name=r(12)
type=red
location=sr(12)

name=r(13)
type=red
location=sr(13)

name=r(14)
type=red
location=sr(14)

name=r(15)
type=red
location=sr(15)

name=r(16)
type=red
location=sr(16)

name=r(17)
type=red
location=sr(17)


[EXPRESSIONS]

CheckMove
  $N = ($M + 1)
  ($M == 5) OR NOT EMPTY("b($L,$N)")
END

SameElementType
  ELTYPE(CONTENT("b($X,$Y)")) == $TP
  $CNT = ($CNT + 1)
  $X = ($X + $DX)
  $Y = ($Y + $DY)
END

Count($DX,$DY)
  $X = ($L + $DX)
  $Y = ($M + $DY)
  $CNT = 0
  FORALL($A,1,3,SameElementType) OR true
  $CNT         
END

Row4
  (Count(-1,0) + Count(1,0)) >= 3
END

Col4
  (Count(0,-1) + Count(0,1)) >= 3
END

Diag4
  (Count(-1,-1) + Count(1,1)) >= 3
END

RDiag4
  (Count(-1,1) + Count(1,-1)) >= 3
END

Has4
  $TP = ELTYPE(CONTENT("b($L,$M)"))
  Row4 OR Col4 OR Diag4 OR RDiag4
END

[SCORINGS]

[END OF GAME]

situation=Has4
winner=(3-PLAYER)

[GAME RULES]
 
name=wstep
element=w($J)
player=1
from=sw($K)
to=b($L,$M)
condition=CheckMove
followup=NEXTPLAYER

name=rstep
element=r($J)
player=2
from=sr($K)
to=b($L,$M)  
condition=CheckMove
followup=NEXTPLAYER